<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Data Affinity | Hazelcast .NET Documentation </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="Data Affinity | Hazelcast .NET Documentation ">
    
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <link rel="stylesheet" href="../../styles/docfx.vendor.min.css">
      <link rel="stylesheet" href="../../styles/docfx.css">
      <link rel="stylesheet" href="../../styles/main.css">
      <link rel="stylesheet" href="../../styles/hz.css">
      <meta property="docfx:navrel" content="../toc.html">
      <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper" class="">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../../index.html">
                <img id="logo" src="../../images/hazelcast-white.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
              <div class="brandcrumb">.NET Client Documentation<br>5.2.2</div>
              <div id="breadhtml">
                <ul class="breadcrumb">
                  <li></li>
                </ul>
              </div>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="data-affinity">Data Affinity</h1>

<p><em>Data affinity</em> ensures that related map entries exist on the same cluster member. If related data is on the same member, operations can be executed without the cost of extra network calls and extra wire data. Hazelcast has a standard way of routing all operations on an entry to the member which owns and manages the entry, based upon the key of the entry. For instance, getting the value of the entry, setting this value, locking the entry, etc. are operations that are all performed by the same member.</p>
<p>This is achieved through <em>partitioning</em>, which consists in assigning a <em>partition identifier</em> to each map entry. The cluster is configured to support a configurable number of partitions (see <a href="https://docs.hazelcast.com/imdg/latest/clusters/partition-group-configuration.html">Partition Group Configuration</a> in the Reference Manual for details), which are distributed randomly and equally among members.</p>
<p>When the client establishes its first connection to the cluster, it receives data from the server, including:</p>
<ul>
<li>the total number of partitions</li>
<li>a table mapping partition identifiers to member identifiers.</li>
</ul>
<h2 id="partitioning">Partitioning</h2>
<p>The partition identifier is determined via the following logic:</p>
<ul>
<li>From the map entry key, a <em>partition key</em> is determined: by default, it is the map entry key itself, but it is possible to use an <a class="xref" href="../api/Hazelcast.Partitioning.Strategies.IPartitioningStrategy.html">IPartitioningStrategy</a> implementation to specify a different object to use</li>
<li>The partition key is hashed to an <code>Int32</code> value, using an optimized algorithm</li>
<li>This hash is modded with the total number of partitions to obtain the partition identifier</li>
</ul>
<p>The <a class="xref" href="../api/Hazelcast.Partitioning.Strategies.IPartitioningStrategy.html">IPartitioningStrategy</a> interface provides one unique method, <a class="xref" href="../api/Hazelcast.Partitioning.Strategies.IPartitioningStrategy.GetPartitionKey.html#Hazelcast_Partitioning_Strategies_IPartitioningStrategy_GetPartitionKey_System_Object_">GetPartitionKey(object)</a>, which returns the partition key. In this case:</p>
<ul>
<li>If the returned partition key is <code>null</code>, the map entry key is used as the partition key</li>
<li>If the returned partition key implements <code>IData</code>, the hash is directly obtained from the <code>IData.PartitionHash</code> property</li>
<li>Otherwise, the partition key is hashed as explained above</li>
</ul>
<h2 id="strategies">Strategies</h2>
<p>Partitioning strategies are explained in details in the <a href="https://docs.hazelcast.com/hazelcast/lastest/performance/data-affinity.html#partitioningstrategy">Reference Manual</a>.</p>
<div class="NOTE">
<h5>Note</h5>
<p>As of version 4.1 the following strategies are internal classes, and it is not possible to configure the global strategy. This will be added in further releases.</p>
</div>
<p>The Hazelcast .NET client proposes different built-in strategies:</p>
<ul>
<li><code>Hazelcast.Partitioning.Strategies.PartitionAwarePartitioningStrategy</code> only for objects implementing <a class="xref" href="../api/Hazelcast.Partitioning.Strategies.IPartitionAware.html">IPartitionAware</a> (else returns <code>null</code>), returns the result of the <a class="xref" href="../api/Hazelcast.Partitioning.Strategies.IPartitionAware.GetPartitionKey.html#Hazelcast_Partitioning_Strategies_IPartitionAware_GetPartitionKey">GetPartitionKey()</a> method</li>
<li><code>Hazelcast.Partitioning.Strategies.StringPartitioningStrategy</code> only for string keys (else returns <code>null</code>), trims chars before the first <code>@</code> char, so &quot;abc&quot; becomes &quot;abc&quot; and &quot;abc@def&quot; becomes &quot;def&quot;, and returns the resulting string</li>
</ul>
<p>The global strategy can be configured via the <code>hazelcast.partitioning.globalStrategy</code> configuration option. The default global strategy is the <code>PartitionAwarePartitioningStrategy</code>.</p>
<p>At server level, it is possible to configure the local strategy used for each map. However, this is not supported by clients. On the other hand, you can implement a custom strategy which applies different logics depending on the type of the object.</p>
</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      Copyright &copy; 2010-2023 Hazelcast, Inc. All rights reserved.<br>Generated by DocFX.
      
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
